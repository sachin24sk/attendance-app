<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Smart Attendance</title>

<style>

body{
margin:0;
font-family:Segoe UI;
background:linear-gradient(135deg,#1976d2,#42a5f5);
display:flex;
justify-content:center;
align-items:center;
min-height:100vh;
padding:15px;
}

.card{
background:white;
width:100%;
max-width:360px;
padding:20px;
border-radius:14px;
box-shadow:0 6px 18px rgba(0,0,0,0.15);
text-align:center;
}

input,button{
width:100%;
padding:12px;
margin-top:12px;
border-radius:10px;
font-size:16px;
}

video{
width:100%;
border-radius:10px;
margin-top:10px;
}

#status{
margin-top:10px;
background:#e3f2fd;
padding:10px;
border-radius:8px;
white-space:pre-line;
font-size:14px;
}

</style>
</head>

<body>

<div class="card">

<h3>ðŸŽ“ Smart Attendance</h3>

<input id="name" placeholder="Enter Name">

<video id="video" autoplay></video>

<button onclick="capturePhoto()">Capture Photo</button>
<canvas id="canvas" width="300" height="220" style="display:none;"></canvas>

<button onclick="markAttendance()">Submit Attendance</button>

<div id="status">Ready...</div>

</div>

<script>

const video=document.getElementById("video");
const statusBox=document.getElementById("status");
let capturedPhoto="";

navigator.mediaDevices.getUserMedia({video:true})
.then(stream=>video.srcObject=stream);

function capturePhoto(){
const canvas=document.getElementById("canvas");
canvas.getContext("2d").drawImage(video,0,0,300,220);
capturedPhoto=canvas.toDataURL("image/png");
statusBox.innerText="Photo captured âœ”";
}

function markAttendance(){

const name=document.getElementById("name").value;

navigator.geolocation.getCurrentPosition(pos=>{
fetch("/api/attendance",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
name,
photo:capturedPhoto,
latitude:pos.coords.latitude,
longitude:pos.coords.longitude,
time:new Date().toLocaleTimeString()
})
})
.then(r=>r.json())
.then(d=>{
statusBox.innerText=d.message+"\n"+d.subject+"\n"+d.date;
});
});

}

</script>

</body>
</html>
