<!DOCTYPE html>
<html>
<head>
<title>Attendance</title>

<style>
body{
font-family:Segoe UI;
background:#f2f4f7;
padding:20px;
}

table{
width:100%;
border-collapse:collapse;
background:white;
}

th{
background:#2c6fb7;
color:white;
padding:10px;
}

td{
padding:10px;
text-align:center;
border-bottom:1px solid #eee;
}

img{
width:45px;
height:45px;
border-radius:50%;
}
</style>
</head>

<body>

<h2>ðŸ“Š Attendance</h2>

<table>
<thead>
<tr>
<th>Photo</th>
<th>Name</th>
<th>Subject</th>
<th>Date</th>
<th>Time</th>
</tr>
</thead>

<tbody id="tableBody"></tbody>

</table>

<script>

const tableBody = document.getElementById("tableBody");

const params = new URLSearchParams(window.location.search);

const password = params.get("password");
const subject  = params.get("subject");

let url = "/api/admin/attendance?password=" + password;

if(subject){
 url += "&subject=" + encodeURIComponent(subject);
}

fetch(url)
.then(res => res.json())
.then(data => {

 console.log("DATA FROM API:",data);

 tableBody.innerHTML="";

 if(!data || data.length===0){
   tableBody.innerHTML =
   "<tr><td colspan='5'>No Attendance Found</td></tr>";
   return;
 }

 data.forEach(a => {

  const row = document.createElement("tr");

  row.innerHTML = `
   <td><img src="${a.photo}"></td>
   <td>${a.name}</td>
   <td>${a.subject}</td>
   <td>${a.date}</td>
   <td>${a.time}</td>
  `;

  tableBody.appendChild(row);
 });

});

</script>

</body>
</html>
